"undefined"!=typeof jQuery&&!function(e){if("undefined"!=typeof wp&&wp.media){var t=wp.media.view.MediaFrame.Select,i=(wp.media.controller.Library,wp.media.view.l10n),o=wp.media.view.Frame,s=null;wp.media.view.EnvatoElements_AttachmentsBrowser=o.extend({tagName:"div",className:"attachments-browser envatoelements-attachments-browser",initialize:function(){_.defaults(this.options,{filters:!1,filteraccount:!1,search:!1,date:!1,display:!1,sidebar:!1,toolbar:!1,AttachmentView:wp.media.view.Attachment.Library}),this.createHackyReactEmbedView()},createHackyReactEmbedView:function(){window.ElementsReact&&envato_elements_react&&this.$el.length>0&&(s=this,window.ElementsReact.elementsDeepPhotos(envato_elements_react,this.$el.get(0),this.photoUploadComplete),setTimeout(function(){var e=jQuery("#elements-search-text");e.length>0&&e[0].focus()},100))},photoUploadComplete:function(e,t){if(t&&t.attachmentData){s.model.frame.content.mode("browse"),s.model.get("selection").add(t.attachmentData),s.model.frame.trigger("library:selection:add");s.model.get("selection");jQuery(".media-frame .media-button-select").click()}},editSelection:function(e){e.$(".media-button-backToLibrary").focus()},dispose:function(){return window.ElementsReact&&this.$el.length>0&&window.ElementsReact.elementor3rdPartyViewClose(this.$el.get(0)),window.location.hash="",o.prototype.dispose.apply(this,arguments),this},createToolbar:function(){var e;e={controller:this.controller},this.controller.isModeActive("grid")&&(e.className="media-toolbar wp-filter"),this.toolbar=new wp.media.view.Toolbar(e),this.views.add(this.toolbar),this.toolbar.set("spinner",new wp.media.view.Spinner({priority:-60})),this.toolbar.set("searchLabel",new wp.media.view.Label({value:"Search",attributes:{"for":"media-search-input"},priority:60}).render()),this.toolbar.set("search",new wp.media.view.Search({controller:this.controller,model:this.collection.props,priority:60}).render())},updateContent:function(){var e,t=this;e=t.attachmentsNoResults,this.collection.length?(e.$el.addClass("hidden"),t.toolbar.get("spinner").hide()):(this.toolbar.get("spinner").show(),this.dfd=this.collection.more().done(function(){t.collection.length?e.$el.addClass("hidden"):e.$el.removeClass("hidden"),t.toolbar.get("spinner").hide()}))},createUploader:function(){this.uploader=new wp.media.view.UploaderInline({controller:this.controller,status:!1,message:this.controller.isModeActive("grid")?"":i.noItemsFound,canClose:this.controller.isModeActive("grid")}),this.uploader.hide(),this.views.add(this.uploader)},toggleUploader:function(){this.uploader.$el.hasClass("hidden")?this.uploader.show():this.uploader.hide()},createAttachments:function(){this.attachments=new wp.media.view.Attachments({controller:this.controller,collection:this.collection,selection:this.options.selection,model:this.model,sortable:this.options.sortable,scrollElement:this.options.scrollElement,idealColumnWidth:this.options.idealColumnWidth,AttachmentView:this.options.AttachmentView}),this.attachments.listenTo(this.controller,"attachment:keydown:arrow",this.attachments.arrowEvent),this.attachments.listenTo(this.controller,"attachment:details:shift-tab",this.attachments.restoreFocus),this.views.add(this.attachments),this.attachmentsNoResults=new o({controller:this.controller,tagName:"p"}),this.attachmentsNoResults.$el.addClass("hidden no-media"),this.attachmentsNoResults.$el.html("Sorry, no images found"),this.views.add(this.attachmentsNoResults)},createSidebar:function(){var e=this.options,t=e.selection,i=this.sidebar=new wp.media.view.Sidebar({controller:this.controller});this.views.add(i),this.controller.uploader&&i.set("uploads",new wp.media.view.UploaderStatus({controller:this.controller,priority:40})),t.on("selection:single",this.createSingle,this),t.on("selection:unsingle",this.disposeSingle,this),t.single()&&this.createSingle()},createSingle:function(){var e=this.sidebar,t=this.options.selection.single();e.set("details",new wp.media.view.Attachment.Details({controller:this.controller,model:t,priority:80})),e.set("compat",new wp.media.view.AttachmentCompat({controller:this.controller,model:t,priority:120})),this.options.display&&e.set("display",new wp.media.view.Settings.AttachmentDisplay({controller:this.controller,model:this.model.display(t),attachment:t,priority:160,userSettings:this.model.get("displayUserSettings")})),"insert"===this.model.id&&e.$el.addClass("visible")},disposeSingle:function(){var e=this.sidebar;e.unset("details"),e.unset("compat"),e.unset("display"),e.$el.removeClass("visible")}}),t.prototype.bindHandlers=function(){this.on("router:create:browse",this.createRouter,this),this.on("router:render:browse",this.browseRouter,this),this.on("content:create:browse",this.browseContent,this),this.on("content:create:envatoelements",this.envatoelements,this),this.on("content:render:upload",this.uploadContent,this),this.on("toolbar:create:select",this.createSelectToolbar,this)},t.prototype.browseRouter=function(e){var t={};t.upload={text:i.uploadFilesTitle,priority:20},t.browse={text:i.mediaLibraryTitle,priority:40},t.envatoelements={text:"Envato Elements",priority:61},e.set(t),setTimeout(function(){jQuery(".media-frame .media-router a.media-menu-item:last-child").addClass("media-menu-item-elements")},800)},t.prototype.envatoelements=function(e){var t=this.state();e.view=new wp.media.view.EnvatoElements_AttachmentsBrowser({controller:this,model:t,AttachmentView:t.get("AttachmentView")})}}}(jQuery);